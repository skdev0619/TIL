# 의존관계 자동 주입

### 다양한 의존관계 주입방법 종류와 각 방법의 특징?
- 생성자
    - 생성자 호출시점에 딱 1번 호출이 보장
    - `불변, 필수` 의존관계에 사용 
    - 생성자가 한 개인 경우 @Autowired 생략 가능

- 수정자 주입(setter_
    - `선택, 변경` 가능성이 있는 의존 관계에 사용

- 필드 주입
    - 사용하지 말자!!
    - 테스트나 @Configuration 설정정보에서 특별한 용도로만 사용
    - 간결하지만 테스트가 힘들다
    - DI 프레임워크가 없으면 아무것도 하기가 힘들다.

- 일반 메소드
    - 사용 거의 안한다.
    - 한 번에 여러 필드 주입 가능

- 옵션처리 종류?
    - @Autowired(required=false)
    - @Nullable
    - Optional<>

## 생성자 주입 선택 권장하는 이유는?
- 대부분의 어플리케이션은 종료시점까지 의존관게 변경할 일이 없고 변하면 안된다.
- 객체를 생성할 때 딱 1번만 호출되므로 불변하게 설계가 가능
- final 키워드 사용 가능하여 값 설정 안되는 오류도 컴파일 시점에 막아준다,
- 테스트 코드 관점
    - 수정자 주입의 경우 public로 열어야 하는데 개발자가 오용할 수 있다.
    - 순수 자바 테스트에서 테스트코드 작성이 힘들다
        - ex) 수정자, 필드 주입
    - 생성자 주입 사용하면 제대로 주입 안했을 떄 컴파일 오류 발생하여 어떤 값을 주입해야하는지 인지가 쉽다.

* 정리
- 기본으로 생성자 주입 사용하고 수정자 주입을 옵션으로 부여
- 필드 주입은 사용하지 말자

## 롬복을 사용한 자동주입 방법은?
- @RequiredArgsConstructor
- final이 붙은 필드 모아서 자동으로 만들어줌

## 조회 빈이 2개 이상인 경우 무슨 일이 생기는지?
- 빈 타입이 같은 경우 : NoUniqueBeanDefinitionException
- 빈 이름이 같은 경우 : ConflictingBeanDefinitionException

## 조회 빈이 2개 이상인 경우 충돌 방지를 위한 @어느테이션 기법 3가지는?
- @Autowired 필드 명
- @Qualifier
- @Primary

### 활용 예시
- ex) 메인 db 커넥션은 @, 서브 데이터베이스 커넥션 @Qualifier

### @Qualifier 어노테이션 직접 만드는 이유?
- @Qualifier 활용 시 참조 찾기가 힘들다. 그 떄 커스텀어노테이션 활용해보자

### 조회 빈이 모두 필요할 때 어떻게 하는지?(List, Map)
`다형성 적극 활용이 가능하다!!!`
```
Map<String, DiscountPolicy>로 주입 가능
key : 스프링 빈 이름
DiscountPolicy : 인터페이스 구현체
```

### 자동, 수동 올바른 실무 기준이 뭔지?
- 편리한 자동 기능을 기본으로 사용하자

### 수동 빈 언제 사용하면 좋을지?
- 업무로직 : 자동 빈 등록
- 기술로직 : 수동 빈 등록

## Map<String, DiscountPolicy> 주의점
- DiscountPolicy에 어떤 구현체가 들어올지 파악이 힘드므로
같은 패키지로 묶도록 유의하자